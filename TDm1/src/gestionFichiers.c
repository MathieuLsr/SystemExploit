#ifndef MACHIN_H
#define MACHIN_H

#include "../headers/gestionFichiers.h"
#include <stdio.h>
#include <stdlib.h>

//Include pour Read
#include <sys/types.h>
#include <sys/uio.h>
#include <unistd.h>

int TAILLEBUF = 100 ; // Taille d'une ligne
int TAILLEMAXFILE = 100000 ; // Taille d'un fichier txt

char* litDixCaracteres(int descriptor){
    int count = 10 ; 
    char* buf = malloc((count+1)*sizeof(char)); 
    buf[count] = '\0' ;
    // Use pread pour pas modifier le pointeur
    read(descriptor, buf, count);
    return buf ;
}

char* litLigne(int descriptor){
    char* buf = malloc((TAILLEBUF+1)*sizeof(char)); 
    buf[TAILLEBUF] = '\0' ;
    // Use pread pour pas modifier le pointeur
    read(descriptor, buf, TAILLEBUF);

    /*
    char* tab = malloc((TAILLEBUF+1)*sizeof(char)); 
    tab[TAILLEBUF] = '\0' ;
    for(int i=0 ; buf[i] != '\0' || i<TAILLEBUF ; i++)  tab[i] = buf[i] ;
    /
    for(int i=0 ; buf[i] != '\0' && buf[i] != '\n' ; i++)
        size = i ; 
    size++ ;
    */
    
    return buf ;

}

char* getAllText(int descriptor){
    char* buf = malloc((TAILLEMAXFILE+1)*sizeof(char)); 
    buf[TAILLEMAXFILE] = '\0' ;
    // Use pread pour pas modifier le pointeur
    ssize_t t = read(descriptor, buf, TAILLEMAXFILE);
    char* tab = malloc(t) ;

    for(int i=0 ; i<t ; i++) tab[i] = buf[i] ;

    //printf(">> %zd\n", t) ;
    return tab ;

}

int getNombreLigne(int descriptor){
    char* buf = malloc((TAILLEMAXFILE+1)*sizeof(char)); 
    buf[TAILLEMAXFILE] = '\0' ;
    // Use pread pour pas modifier le pointeur
    ssize_t t = read(descriptor, buf, TAILLEMAXFILE);

    int i = t/TAILLEBUF ;
    printf(">> ssize_t : %zd\n", t) ;
    printf(">> t / taillebuf : %d\n", i) ;

    if(i*TAILLEBUF != t) i++ ;

    return i ;

}

void afficheTab(char* tab){
    printf("%s\n", tab) ;
}


#endif